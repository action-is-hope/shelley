import {
  Meta,
  Canvas,
  Story,
  Preview,
  Source,
  ArgsTable,
  Props,
} from "@storybook/addon-docs";
import { DisclosureGroup } from "../../indexLib";
import dedent from "ts-dedent";
import {
  DisclosureGroupPropsTable,
  SingleDisclosure,
  SingleDisclosureCustomIcon,
  DisclosureControlledExample,
  DynamicDisclosureGroup,
  SingleDisclosure2,
  Example3,
} from "./DisclosureGroup.examples";

<Meta title="Data/DisclosureGroup" component={DisclosureGroup} />

# Disclosures

<Source
  language="tsx"
  code={dedent`
    import { Disclosure, DisclosureGroup } from "@actionishope/shelley/Disclosure";
  `}
/>

A Disclosure component allows users to toggle the visibility of additional content by clicking on a title or trigger. It offers a convenient way to expand or collapse sections of information, providing a more organised and user-friendly presentation of content.

## Single Disclosure

Disclosure can be used directly or indirectly via DiaclosureGroup, the example below demonstrates a single Disclosure with the icon position set to `end`.

<Story
  name="a) Disclosure"
  parameters={{
    docs: {
      source: {
        code: dedent`
<Disclosure
  title="Single Disclosure"
  triggerProps={{ iconPos: "end", vol: 5 }}
>
  <>
    <H2 vol={3}>Disclosure title</H2>
    <P vol={2}>Some content inside of the Disclosure.</P>
  </>
</Disclosure>`,
      },
    },
  }}
>
  {SingleDisclosure.bind({})}
</Story>

<Source language="tsx" id="data-disclosuregroup--a-disclosure" />

We are leveraging the `triggerProps` here which allows you to use any of the visual props associated with the Button component (Disclosure uses Button for the Trigger). All of the visual props are set to `false` by default so you can choose to apply your own styling rather than use that of the Button.

**Note:** `iconPos` can be provided directly or as part of the `triggerProps` (as above) where it will take precedence.

## Custom Icon

It is possible to override the default icon but it must be wrapped in an Icon component in order for it to work properly.

<Story
  name="b) Disclosure Icon"
  parameters={{
    docs: {
      source: {
        code: dedent`
import { Icon, IconProps } from "@actionishope/shelley/Icon";\n
const CustomIcon: React.VFC<IconProps> = () => (
  /* This is a Material UI icon so we set the viewBox accordingly. */
  <Icon viewBox="0 0 24 24">
    <path d="m20 12-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"></path>
  </Icon>
);\n
<Disclosure
  title="Single Disclosure"
  triggerIcon={CustomIcon}
  iconPos="end"
>
  <>
    <H2 vol={3}>Disclosure title</H2>
    <P vol={2}>Some content inside of the Disclosure.</P>
  </>
</Disclosure>
`,
      },
    },
  }}
>
  {SingleDisclosureCustomIcon.bind({})}
</Story>

<Source language="tsx" id="data-disclosuregroup--b-disclosure-icon" />

### Events

Setting a selected option can be done by using the defaultSelectedKey or selectedKey prop. The selected key corresponds to the key of an item. When Select is used with a dynamic collection as described above, the key of each item is derived from the data. See the react-stately Selection docs for more details.

<Story
  name="b) Events"
  parameters={{
    docs: {
      source: {
        code: dedent`
<Disclosure title="Single Disclosure" iconPos="end" >
  <>
    <H2 vol={4}>Disclosure title</H2>
    <P>Some content inside of the Disclosure.</P>
  </>
</Disclosure>`,
      },
    },
  }}
>
  {DisclosureControlledExample.bind({})}
</Story>

<Source language="tsx" id="data-disclosuregroup--a-disclosure" />

## Example

This example displays a disclosure group with an optional title and a list of items.
Items are passed as an array of objects with a title and items property.

<Preview>
  <Story
    name="Example3"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
TBC`,
        },
      },
    }}
  >
    <Example3 />
  </Story>
</Preview>

<Preview>
  <Story
    name="SingleDisclosure2"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
TBC`,
        },
      },
    }}
  >
    <SingleDisclosure2 />
  </Story>
</Preview>

<Preview>
  <Story
    name="a) Disclosure Group"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
            <DisclosureGroup
              title="Disclosure Group"
              items={items}"
            />`,
        },
      },
    }}
  >
    <DynamicDisclosureGroup />
  </Story>
</Preview>

### Example Usage

```jsx
<DisclosureGroup
  title="Disclosure Group"
  className="my-disclosure-group"
  items={[
    {
      id: "item1",
      title: "Item 1",
      children: <p>This is the content of item 1.</p>,
    },
    {
      id: "item2",
      title: "Item 2",
      children: <p>This is the content of item 2.</p>,
    },
  ]}
  data-id="my-disclosure-group"
/>
```

### How it Works

### Accessibility

The `DisclosureGroup` component is designed with accessibility in mind. It uses semantic
HTML elements and applies appropriate ARIA attributes to ensure screen readers and
assistive technologies can properly interpret and interact with the disclosure items.

Each disclosure item's trigger element (button) has `aria-expanded` and
`aria-controls` attributes that indicate the expanded/collapsed state and the corresponding
hidden content element. The hidden content element has `aria-hidden` and `aria-labelledby`
attributes to convey its visibility and association with the trigger element.

Make sure to provide meaningful and descriptive titles for each disclosure item to
aid users who rely on assistive technologies.

### Testing

You can use the `"data-id"` prop to add custom data attributes to the `DisclosureGroup` component and its child elements.
This can be helpful for selecting and interacting with the component during testing.
The value of `"data-id"` is appended with specific identifiers to create unique data attribute values for each element within the component.

For example, if you set `data-id="my-disclosure-group"`, the root `<div>` element will
have `data-id="my-disclosure-group"`,
the `<ul>` element will have `data-id="my-disclosure-group--accordion"`, and so on.
This allows you to target specific elements during testing by their data attributes.

Ensure that you have appropriate testing frameworks and libraries set up in your project
to write tests for the `DisclosureGroup` component and verify its behavior and rendering.

That covers the detailed documentation for the `DisclosureGroup` component, including its usage,
behavior, styling, accessibility considerations, and testing recommendations.
Feel free to adapt and expand upon this documentation based on your project's specific
requirements and guidelines.

### DisclosureGroup Props

<ArgsTable of={DisclosureGroupPropsTable} />

The `DisclosureGroup` component accepts the following props:

- `className` (string, optional): Additional CSS class name(s) to be applied to the root `<div>` element of the component.
- `items` (array of DisclosureProps): An array of objects representing the individual
  disclosure items to be rendered within the group.
- `"data-id"` (string, optional): A custom data attribute to be added to the root `<div>`
  element and all child elements within the component. This can be used for testing or other custom purposes.

### Disclosure Props

Each object in the `items` array represents a disclosure item and should have the following properties:

- `id` (string): A unique identifier for the disclosure item.
- `title` (string): The title or heading of the disclosure item.
- `children` (ReactNode): The content to be displayed when the disclosure item is expanded.

### Styling

To style the `DisclosureGroup` component, you can pass a `className` prop with additional CSS classes to the
component. The root `<div>` element of the component will have these classes applied,
allowing you to customize the appearance of the disclosure group.

Additionally, you can target the individual elements within the `DisclosureGroup`
component using CSS selectors and styling rules based on their class names.
The specific class names used in the component's rendering can be found in the code,
such as `classes.root`, `classes.disclosure`,
`classes.trigger`, `classes.title`, `classes.transition`, and `classes.content`.

## Single Disclosure

This example displays a single disclosure usage with an optional title and a
list of radio buttons. Items are passed as children.

<Preview>
  <Story
    name="b) Disclosure"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
            <Disclosure id="itemId" title="Single Disclosure" data-id="disclosure">
              <RadioGroup label="Are you a wizard?" defaultValue="yes">
                <Radio value="yes">Yes</Radio>
                <Radio value="no">No</Radio>
              </RadioGroup>
            </Disclosure>`,
        },
      },
    }}
  >
    <SingleDisclosure />
  </Story>
</Preview>
