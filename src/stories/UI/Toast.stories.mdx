import { Meta, Canvas, Story, Preview, Props } from "@storybook/addon-docs";
import { Toast } from "../../indexLib";
import { ArgsTable, Source } from "@storybook/addon-docs";
import dedent from "ts-dedent";
import {
  ToastProviderDefault,
  ToastProviderPriority,
  ToastProviderActionLabel,
  ToastProviderAutoDismiss,
  ToastProviderCloseOnAction,
  ToastProviderWithoutIcon,
} from "./Toast.examples";

<Meta title="Status/Toast" component={Toast} />

# Toast

<Source
  language="tsx"
  code={dedent`
    import { ToastProvider } from "@actionishope/shelley";
  `}
/>

Toast is used for displaying a short message to the user. It is a non-modal, time-based notification that appears in the bottom right corner or bottom center of the screen. Toasts are used to provide feedback on an action that the user has taken, such as saving a file or sending a message.

## Default Toast

This example displays the most basic/default toast with no priority or auto-dismissal or action button.

<Preview>
  <Story
    name="a) Default Toast"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
          import { ToastProvider, useToast } from "../../components/Toast/ToastProvider";
import Button from "../../components/Button/Button";\n
const ToastTriggersForDefaultExample = () => {
  const state = useToast();\n
  return (
    <Button
      onClick={() => state.add({ title: "New toast" })}
      style={{ margin: "16px" }}
    >
      Add toast!
    </Button>
  );
};\n
export const ToastProviderDefault = () => {
  return (
    <ToastProvider>
      <ToastTriggersForDefaultExample />
    </ToastProvider>
  );
};`,
        },
      },
    }}
  >
    <ToastProviderDefault />
  </Story>
</Preview>

<Source language="tsx" id="data-toast--a-default-toast" />

## Toasts with Priority

This example displays adding toasts with different priorities.
An error might be a high priority, a warning a medium priority and success a low priority.
The default priority is 0 and can be 0, 1, 2 or 3.
The higher the number the higher the priority.
Toasts with higher priority will be displayed first.

<Preview>
  <Story
    name="b) Toast Priority"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
    <ToastProvider>
      {(state) => (
        <>
          <Button
            onClick={() => state.add("Toasting...! (1)", { priority: 1 })}
            style={{ margin: "16px" }}
          >
            Low priority(1) - info or success
          </Button>
          <Button
            onClick={() => state.add("Toast is done! (2)", { priority: 2 })}
            style={{ margin: "16px" }}
          >
            Medium priority(2) - warning
          </Button>
          <Button
            onClick={() => state.add("Toast is burnt! (3)", { priority: 3 })}
            style={{ margin: "16px" }}
          >
            High priority(3) - error
          </Button>
        </>
      )}
    </ToastProvider>`,
        },
      },
    }}
  >
    <ToastProviderPriority />
  </Story>
</Preview>

<Source language="tsx" id="data-toast--b-toast-priority" />

## Toast with Action Button

This example displays adding toasts with action buttons.
Action buttons can be used to provide the user with a way to interact with the toast.
For example, if the toast is displaying an error, the action button could be used to provide a way to fix the error.
The action button has the option to close the toast when clicked besides performing the action.

<Preview>
  <Story
    name="c) Toast Action Buttons"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
    <ToastProvider>
      {(state) => {
        return (
          <>
            <Button
              onClick={() =>
                state.add(
                  {
                    title: "Bread can be toasted.",
                    actionLabel: "Got it",
                    shouldCloseOnAction: true,
                    onAction: () => console.log("Action was clicked!"),
                  },
                  { priority: 0 }
                )
              }
              style={{ margin: "16px" }}
            >
              No priority - info
            </Button>
            <Button
              onClick={() =>
                state.add(
                  {
                    title: "Toasting...! (1)",
                    actionLabel: "Thanks",
                    shouldCloseOnAction: true,
                    onAction: () => console.log("Action was clicked!"),
                  },
                  { priority: 1 }
                )
              }
              style={{ margin: "16px" }}
            >
              Low priority(1) - success
            </Button>
            <Button
              onClick={() =>
                state.add(
                  {
                    title: "Toast is done! (2)",
                    actionLabel: "Check",
                    shouldCloseOnAction: true,
                    onAction: () => console.log("Action was clicked!"),
                  },
                  { priority: 2 }
                )
              }
              style={{ margin: "16px" }}
            >
              Medium priority(2) - warning
            </Button>
            <Button
              onClick={() =>
                state.add(
                  {
                    title: "Toast is burnt! (3)",
                    actionLabel: "Fix",
                    shouldCloseOnAction: true,
                    onAction: () => console.log("Action was clicked!"),
                  },
                  { priority: 3 }
                )
              }
              style={{ margin: "16px" }}
            >
              High priority(3) - error
            </Button>
          </>
        );
      }}
    </ToastProvider>`,
        },
      },
    }}
  >
    <ToastProviderActionLabel />
  </Story>
</Preview>

<Source language="tsx" id="data-toast--c-toast-action-button" />

## Toast with Auto Dismissal

This example displays adding toasts with auto-dismissal.
Auto-dismissal is used to automatically close the toast after a certain amount of time.

<Preview>
  <Story
    name="d) Auto Dismiss"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
    <ToastProvider>
      {(state) => (
        <>
          <Button
            onClick={() =>
              state.add(
                { title: "Disappears in 3.5 seconds" },
                { timeout: 3500 }
              )
            }
            style={{ margin: "16px" }}
          >
            Add toast!
          </Button>
        </>
      )}
    </ToastProvider>`,
        },
      },
    }}
  >
    <ToastProviderAutoDismiss />
  </Story>
</Preview>

<Source language="tsx" id="data-toast--d--toast-auto-dismissal" />

## Toast with Action button that closes the toast

This example displays a toast which closes when the action button is clicked.
The action button has the option to close the toast when clicked besides performing the action.

<Preview>
  <Story
    name="e) Close on Action"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
    <ToastProvider>
      {(state) => (
        <>
          <Button
            onClick={() =>
              state.add({
                title: "Should close on action",
                actionLabel: "Action",
                shouldCloseOnAction: true,
                onAction: () => console.log("Action was clicked!"),
              })
            }
            style={{ margin: "16px" }}
          >
            Add toast!
          </Button>
        </>
      )}
    </ToastProvider>`,
        },
      },
    }}
  >
    <ToastProviderCloseOnAction />
  </Story>
</Preview>

<Source language="tsx" id="data-toast--e-toast-close-on-action" />

## Toast without icon

This example displays a toast which has no icon.

<Preview>
  <Story
    name="f) No icon"
    args={{}}
    parameters={{
      docs: {
        source: {
          code: dedent`
    <ToastProvider>
      {(state) => (
        <>
          <Button
            onClick={() =>
              state.add({
                title: "No icon",
                shouldShowIcon: false,
              })
            }
            style={{ margin: "16px" }}
          >
            Add toast!
          </Button>
        </>
      )}
    </ToastProvider>`,
        },
      },
    }}
  >
    <ToastProviderWithoutIcon />
  </Story>
</Preview>

<Source language="tsx" id="data-toast--f-toast-no-icon" />

### Features

- **Accessible** – Toasts follow the ARIA alert pattern. They are rendered in a landmark region, which keyboard and screen reader users can easily jump to when an alert is announced.
- **Focus management** – When a toast unmounts, focus is moved to the next toast if any. Otherwise, focus is restored to where it was before navigating to the toast region.
- **Priority queue** – Toasts are displayed according to a priority queue, displaying a configurable number of toasts at a time. The queue can either be owned by a provider component, or global.
- **Animations** – Toasts support optional entry and exit animations.

### Anatomy

A toast region is an ARIA landmark region labeled "Notifications" by default. A toast region contains one or more visible toasts, in priority order. When the limit is reached, additional toasts are queued until the user dismisses one. Each toast is an ARIA alert element, containing the content of the notification and a close button.

Landmark regions including the toast container can be navigated using the keyboard by pressing the <kbd>F6</kbd> key to move forward, and the <kbd>Shift</kbd> + <kbd>F6</kbd> key to move backward. This provides an easy way for keyboard users to jump to the toasts from anywhere in the app. When the last toast is closed, keyboard focus is restored.

### Keyboard Activation

| Key            | Interaction                                                                                                  |
| -------------- | ------------------------------------------------------------------------------------------------------------ |
| Tab            | Places the focus on the next interactive element, which is either a button or a close button.                |
| Shift + Tab    | Places the focus on the previous interactive element, which is either a button or a close button.            |
| Space or Enter | If focus is on the close button, dismisses the toast. If focus is on the button, executes the button action. |
| F6             | Places the focus on to the toast region.                                                                     |

## Usage

The following examples show how to use create Toasts / Notifications using the ToastProvider.

First, wrap your app component in a `<ToastProvider/>`. This component is responsible for rendering the toast region and in turn the toasts and managing the toast queue.

<Source
  language="tsx"
  code={dedent`
    import { ToastProvider, useToast } from "@actionishope/shelley";
  `}
/>

Then use the `useToast` hook to add toasts to the queue.

<Source
  language="tsx"
  code={dedent`
    <Button
      onClick={() => state.add({ title: "New toast" })}
    >
      Add toast!
    </Button>
  `}
/>
